---
title: Jenkins + GitHub å®ç° Push è‡ªåŠ¨è§¦å‘æ„å»º
date: "2025-12-06"
category: "Jenkins"
tags: ["Jenkins", "GitHub", "Webhook", "CI/CD", "è‡ªåŠ¨æ„å»º"]
excerpt: "ä»‹ç»åœ¨ Ubuntu äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„ Jenkins ä¸­ï¼Œå®ç° GitHub ä»£ç  push åè‡ªåŠ¨è§¦å‘ Jenkins æ„å»ºã€‚"
---

# Jenkins + GitHub å®ç° Push è‡ªåŠ¨è§¦å‘æ„å»º

æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ Ubuntu äº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„ Jenkins ä¸­ï¼Œé€šè¿‡é…ç½® GitHub Webhook å®ç°ä»£ç æ¨é€åè‡ªåŠ¨è§¦å‘ Jenkins æ„å»ºä»»åŠ¡çš„å®Œæ•´æ–¹æ¡ˆã€‚

---

## ğŸ“‹ å·¥ä½œåŸç†

å½“å¼€å‘è€…åœ¨æœ¬åœ°æ‰§è¡Œä»£ç æ¨é€æ“ä½œï¼š

```bash
git add .
git commit -m "update"
git push origin main
```

ç³»ç»Ÿå°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š

1. GitHub æ¥æ”¶ä»£ç æ¨é€äº‹ä»¶
2. GitHub è§¦å‘ Webhook å‘ Jenkins å‘é€é€šçŸ¥
3. Jenkins æ¥æ”¶ Webhook è¯·æ±‚å¹¶è‡ªåŠ¨è§¦å‘æ„å»ºä»»åŠ¡ï¼ˆä»£ç æ‹‰å–ã€ç¼–è¯‘ã€æ‰“åŒ…ã€éƒ¨ç½²ç­‰ï¼‰
4. æ„å»ºå®Œæˆåè¾“å‡ºæ„å»ºæ—¥å¿—å’Œç»“æœ

---

## âš™ï¸ ç¯å¢ƒè¦æ±‚

1. **Jenkins æœåŠ¡**ï¼šå·²éƒ¨ç½²åœ¨ Ubuntu äº‘æœåŠ¡å™¨ä¸Š
2. **ç½‘ç»œè®¿é—®**ï¼šJenkins æœåŠ¡éœ€å…·å¤‡å…¬ç½‘è®¿é—®èƒ½åŠ›ï¼ˆä¾‹å¦‚ `https://ducrong.com/jenkins/`ï¼‰
3. **å¿…éœ€æ’ä»¶**ï¼šç¡®ä¿å·²å®‰è£…ä»¥ä¸‹ Jenkins æ’ä»¶ï¼š
   - âœ… `GitHub` plugin
   - âœ… `GitHub Integration` plugin
   - âœ… `Git plugin`
   - âœ… `Pipeline`ï¼ˆå¦‚ä½¿ç”¨ Pipeline æµæ°´çº¿ï¼‰

> æ’ä»¶å®‰è£…è·¯å¾„ï¼š**Manage Jenkins â†’ Plugins â†’ Available Plugins â†’ æœç´¢å¹¶å®‰è£…**

---

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ

- **Webhook**ï¼šGitHub åœ¨ç‰¹å®šäº‹ä»¶ï¼ˆå¦‚ pushï¼‰å‘ç”Ÿæ—¶å‘æŒ‡å®š URL å‘é€ HTTP POST è¯·æ±‚çš„æœºåˆ¶
- **æ„å»ºè§¦å‘å™¨**ï¼šJenkins ä¸­ç”¨äºè‡ªåŠ¨å¯åŠ¨æ„å»ºä»»åŠ¡çš„é…ç½®é¡¹
- **Personal Access Token**ï¼šGitHub æä¾›çš„ç”¨äº API è®¤è¯çš„è®¿é—®ä»¤ç‰Œ

---

## ğŸš€ é…ç½®æ­¥éª¤

### 1ï¸âƒ£ é…ç½® GitHub å‡­æ®

1. è¿›å…¥ Jenkins ç®¡ç†ç•Œé¢ï¼š**Manage Jenkins â†’ Configure System**
2. å®šä½åˆ° **GitHub** é…ç½®åŒºåŸŸ
3. æ·»åŠ  GitHub æœåŠ¡å™¨ï¼šç‚¹å‡» "Add GitHub Server" â†’ é€‰æ‹© "GitHub.com"
4. é…ç½®è®¿é—®å‡­æ®ï¼š
   - åœ¨ GitHub ä¸Šåˆ›å»º **Personal Access Token**ï¼ˆè®¿é—®åœ°å€ï¼š[https://github.com/settings/tokens](https://github.com/settings/tokens)ï¼‰
   - é€‰æ‹©ä»¥ä¸‹æƒé™èŒƒå›´ï¼ˆScopesï¼‰ï¼š

     ```text
     repo, admin:repo_hook, workflow
     ```

   - åœ¨ Jenkins ä¸­æ·»åŠ å‡­æ®ï¼šç±»å‹é€‰æ‹© "Secret text"ï¼Œå°† Token å€¼å¡«å…¥
5. éªŒè¯è¿æ¥ï¼šç‚¹å‡» "Test Connection"
   - æˆåŠŸæç¤ºï¼š`Credentials verified for user <username>, rate limit: xxxx` âœ…

---

### 2ï¸âƒ£ å¯ç”¨ Jenkins æ„å»ºè§¦å‘å™¨

1. è¿›å…¥ Jenkins Job é…ç½®é¡µé¢ï¼šé€‰æ‹©ç›®æ ‡ Job â†’ ç‚¹å‡» **Configure**
2. åœ¨ **Build Triggersï¼ˆæ„å»ºè§¦å‘å™¨ï¼‰** åŒºåŸŸä¸­å‹¾é€‰ï¼š

```text
GitHub hook trigger for GITScm polling
```

**å·¥ä½œåŸç†è¯´æ˜**ï¼š
> å¯ç”¨æ­¤è§¦å‘å™¨åï¼Œå½“ GitHub æ¥æ”¶åˆ° push äº‹ä»¶æ—¶ï¼Œä¼šé€šè¿‡ Webhook ä¸»åŠ¨é€šçŸ¥ Jenkinsï¼Œ  
> Jenkins ç«‹å³å“åº”å¹¶æ‰§è¡Œæ„å»ºä»»åŠ¡ï¼Œæ— éœ€å®šæœŸè½®è¯¢ä»“åº“ï¼Œå“åº”æ›´åŠæ—¶ã€èµ„æºæ¶ˆè€—æ›´ä½ã€‚

---

### 3ï¸âƒ£ åœ¨ GitHub ä»“åº“ä¸­é…ç½® Webhook

**é…ç½®è·¯å¾„**ï¼š  
**GitHub ä»“åº“ â†’ Settings â†’ Webhooks â†’ Add webhook**

**é…ç½®å‚æ•°**ï¼š

| å­—æ®µ | é…ç½®å€¼ | è¯´æ˜ |
|------|--------|------|
| Payload URL | `https://ducrong.com/jenkins/github-webhook/` | Jenkins Webhook æ¥æ”¶åœ°å€ |
| Content type | `application/json` | è¯·æ±‚å†…å®¹ç±»å‹ |
| Secret | å¯ç•™ç©ºï¼ˆæˆ–è‡ªå®šä¹‰ï¼‰ | ç”¨äºéªŒè¯è¯·æ±‚çš„å¯†é’¥ï¼ˆå¯é€‰ï¼‰ |
| Which events | `Just the push event` | è§¦å‘äº‹ä»¶ç±»å‹ |
| Active | âœ… å‹¾é€‰ | å¯ç”¨ Webhook |

> **é‡è¦æç¤º**ï¼šPayload URL å¿…é¡»ä»¥ `/github-webhook/` ç»“å°¾ï¼Œè¿™æ˜¯ Jenkins çš„å›ºå®š Webhook ç›‘å¬ç«¯ç‚¹ã€‚

**éªŒè¯è¿æ¥**ï¼š  
ä¿å­˜é…ç½®åï¼ŒGitHub ä¼šè‡ªåŠ¨å‘èµ·ä¸€æ¬¡ `ping` è¯·æ±‚è¿›è¡Œè¿æ¥æµ‹è¯•ï¼›  
è‹¥ Jenkins è¿”å› `200 OK` çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤º Webhook é…ç½®æˆåŠŸã€‚

---

### 4ï¸âƒ£ éªŒè¯è‡ªåŠ¨æ„å»ºåŠŸèƒ½

**æµ‹è¯•æ­¥éª¤**ï¼š

1. åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•æ‰§è¡Œä»£ç æ¨é€ï¼š

   ```bash
   git push origin main
   ```

2. éªŒè¯æ„å»ºè§¦å‘ï¼š
   - æ£€æŸ¥ Jenkins æ§åˆ¶å°ï¼šæŸ¥çœ‹æ˜¯å¦è‡ªåŠ¨åˆ›å»ºå¹¶æ‰§è¡Œäº†æ–°çš„æ„å»ºä»»åŠ¡
   - æ£€æŸ¥ GitHub Webhook æ—¥å¿—ï¼šè¿›å…¥ **Settings â†’ Webhooks â†’ Recent Deliveries**ï¼Œç¡®è®¤è¯·æ±‚çŠ¶æ€ä¸º `200 OK`

---

## ğŸ§° å†…ç½‘ç¯å¢ƒè§£å†³æ–¹æ¡ˆ

å¦‚æœ Jenkins éƒ¨ç½²åœ¨å†…ç½‘ç¯å¢ƒï¼Œæ— æ³•è¢« GitHub ç›´æ¥è®¿é—®ï¼Œå¯é‡‡ç”¨ä»¥ä¸‹æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆ 1ï¼šä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·ï¼ˆngrokï¼‰

ä½¿ç”¨ ngrok å°†æœ¬åœ° Jenkins æœåŠ¡æ˜ å°„åˆ°å…¬ç½‘ï¼š

```bash
ngrok http 8080
```

ngrok ä¼šç”Ÿæˆä¸€ä¸ªå…¬ç½‘è®¿é—®åœ°å€ï¼ˆä¾‹å¦‚ `https://xxxx.ngrok.io`ï¼‰ï¼Œ  
å°†ç”Ÿæˆçš„åœ°å€é…ç½®åˆ° GitHub Webhook çš„ Payload URL ä¸­ã€‚

**æ³¨æ„äº‹é¡¹**ï¼š

- ngrok å…è´¹ç‰ˆåœ°å€ä¼šå˜åŒ–ï¼Œæ¯æ¬¡é‡å¯éœ€æ›´æ–° Webhook é…ç½®
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ä»˜è´¹ç‰ˆæˆ–è‡ªå»ºå†…ç½‘ç©¿é€æœåŠ¡

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨åå‘ä»£ç†ï¼ˆNginx / Cloudflareï¼‰

é€šè¿‡ Nginx æˆ– Cloudflare ç­‰åå‘ä»£ç†æœåŠ¡ï¼Œå°†å…¬ç½‘åŸŸåæ˜ å°„åˆ°å†…ç½‘ Jenkins æœåŠ¡ï¼š

- é…ç½®åå‘ä»£ç†è§„åˆ™ï¼Œå°† `https://ducrong.com/jenkins/github-webhook/` è½¬å‘åˆ°å†…ç½‘ Jenkins
- ç¡®ä¿åå‘ä»£ç†æ”¯æŒ WebSocketï¼ˆå¦‚ Jenkins ä½¿ç”¨ WebSocket é€šä¿¡ï¼‰
- é…ç½® SSL è¯ä¹¦ä»¥æ”¯æŒ HTTPS è®¿é—®

---

## ğŸ§¾ æ•…éšœæ’æŸ¥

| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|---------|---------|
| Webhook è¿”å› 403 Forbidden | æœªå¯ç”¨æ„å»ºè§¦å‘å™¨æˆ– URL é…ç½®é”™è¯¯ | æ£€æŸ¥ Payload URL æ˜¯å¦ä»¥ `/github-webhook/` ç»“å°¾ï¼Œç¡®è®¤ Jenkins Job ä¸­å·²å‹¾é€‰ "GitHub hook trigger for GITScm polling" |
| ä»£ç æ‹‰å–å¤±è´¥ | Git å‡­æ®é…ç½®é”™è¯¯æˆ–æƒé™ä¸è¶³ | æ£€æŸ¥ Jenkins ä¸­é…ç½®çš„ Git å‡­æ®ï¼ˆSSH key æˆ– Personal Access Tokenï¼‰æ˜¯å¦æ­£ç¡®ï¼Œç¡®è®¤ Token å…·æœ‰ä»“åº“è®¿é—®æƒé™ |
| Webhook è¯·æ±‚è¶…æ—¶æˆ–æ— æ³•è®¿é—® | Jenkins æœåŠ¡æœªæš´éœ²åˆ°å…¬ç½‘ | ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·ï¼ˆå¦‚ ngrokï¼‰æˆ–é…ç½®åå‘ä»£ç†ï¼ˆNginx/Cloudflareï¼‰ |
| æ„å»ºæœªè‡ªåŠ¨è§¦å‘ | Webhook é…ç½®é”™è¯¯æˆ– Jenkins æœªæ¥æ”¶è¯·æ±‚ | æ£€æŸ¥ GitHub Webhook çš„ Recent Deliveries æ—¥å¿—ï¼ŒæŸ¥çœ‹è¯·æ±‚çŠ¶æ€å’Œå“åº”å†…å®¹ï¼›æ£€æŸ¥ Jenkins ç³»ç»Ÿæ—¥å¿— |

---

## ğŸ§© å®Œæ•´æµç¨‹å›¾

ä¸‹é¢æ˜¯ GitHub ä¸ Jenkins è‡ªåŠ¨è§¦å‘çš„ç®€æ˜æµç¨‹ï¼š

```text
å¼€å‘è€…æœ¬åœ°
    â”‚
    â”‚ git push origin main
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GitHub    â”‚  æ¥æ”¶ push äº‹ä»¶
â”‚  ä»“åº“æ›´æ–°   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ è§¦å‘ Webhook
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GitHub    â”‚  å‘é€ POST è¯·æ±‚
â”‚  Webhook    â”‚  â†’ /github-webhook/
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ HTTP POST
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Jenkins   â”‚  æ¥æ”¶ Webhook
â”‚  æœåŠ¡å™¨     â”‚  è‡ªåŠ¨è§¦å‘æ„å»º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ æ‰§è¡Œæ„å»ºä»»åŠ¡
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Jenkins   â”‚  1. æ‹‰å–æœ€æ–°ä»£ç 
â”‚  æ„å»ºæµç¨‹   â”‚  2. ç¼–è¯‘/æ‰“åŒ…
â”‚             â”‚  3. éƒ¨ç½²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ å®Œæˆ
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ„å»ºæ—¥å¿—   â”‚  è¾“å‡ºæ„å»ºç»“æœ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‰ æ€»ç»“

é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œå¯ä»¥å®ç°å®Œæ•´çš„æŒç»­é›†æˆæµç¨‹ï¼š

> å½“ä»£ç æ¨é€åˆ° GitHub ä»“åº“åï¼ŒJenkins å°†è‡ªåŠ¨è§¦å‘æ„å»ºä»»åŠ¡ï¼Œæ‰§è¡Œä»£ç æ‹‰å–ã€ç¼–è¯‘ã€æ‰“åŒ…ã€éƒ¨ç½²ç­‰æ“ä½œï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š

- âœ… è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹ï¼Œå‡å°‘äººå·¥æ“ä½œ
- âœ… å®æ—¶å“åº”ä»£ç å˜æ›´ï¼Œæå‡å¼€å‘æ•ˆç‡
- âœ… åŸºäº Webhook çš„äº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œèµ„æºæ¶ˆè€—ä½
- âœ… å®ç°çœŸæ­£çš„æŒç»­é›†æˆï¼ˆCIï¼‰å®è·µ

é€šè¿‡æ­¤æ–¹æ¡ˆï¼Œå¯ä»¥å»ºç«‹é«˜æ•ˆçš„ CI/CD å·¥ä½œæµï¼Œæå‡è½¯ä»¶äº¤ä»˜è´¨é‡å’Œé€Ÿåº¦ã€‚
